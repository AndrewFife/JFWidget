
<!-- saved from url=(0049)https://static.wcasd.net/jotform_widget_test.html -->
<html data-lt-installed="true"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
      <style>
         html *
         {
            font-size: 1em !important;
            color: #000 !important;
            font-family: Arial !important;
         }
         .box{
         padding: 2px;
         display: none;
         margin-top: 20px;
         }
         .dropdowns {
            appearance: none;
            max-width: 400px;
            width: 100%;
            height: 2.5em;
            color: black;
            font-weight: 300;
            background-color: #fff;
            border-color: #b8bdc9;
            font-size: 16px;
            border-radius: 4px;
            border-width: 1px;
            border-style: solid;
            display: block;
            padding: 0 1.875em 0 .625em;
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='10' height='6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l4 4 4-4' stroke='%2357647E' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-position: right 10px bottom 50%;
            background-size: .625em;
            background-repeat: no-repeat;
            outline: 0;
            margin: 0;
            text-align: left
         }
         
         .dropdowns:hover {
            border-color: rgba(46, 105, 255, .5);
            box-shadow: 0 0 0 2px rgb(46 105 255 / 25%)
         }
         
         .dropdowns:focus {
            border-color: #2e69ff;
            box-shadow: 0 0 0 3px rgb(46 105 255 / 25%);
            outline: 0
         }
      </style>

   </head>
   <body>
      <script src="./jotform_widget_test_files/jquery.min.js"></script>
      <script src="./jotform_widget_test_files/jquery-3.5.1.js"></script>
      <script src="./jotform_widget_test_files/for-custom-widgets.js"></script>
    
      <form>
      
      <select class="dropdowns" id="sel" data-component="dropdown">
         <option value="">Select option</option>
         <option value="0"> West Chester East High School</option>
         <option value="1"> B. Reed Henderson High School</option>
         <option value="2"> Bayard Rustin High School</option>
         <option value="3"> J. R. Fugett Middle School</option>
         <option value="4"> E. N. Peirce Middle School</option>
         <option value="5"> G. A. Stetson Middle School</option>
         <option value="6"> East Bradford Elementary School</option>
         <option value="7"> East Goshen Elementary School</option>
         <option value="8"> Exton Elementary School</option>
         <option value="9"> Fern Hill Elementary School</option>
         <option value="10"> Glen Acres Elementary School</option>
         <option value="11"> Greystone Elementary School</option>
         <option value="12"> Hillsdale Elementary School</option>
         <option value="13"> Mary C. Howse Elementary School</option>
         <option value="14"> Penn Wood Elementary School</option>
         <option value="15"> Sarah Starkweather Elementary School</option>
         <option value="16"> Westtown Thornbury Elementary School</option>
      </select>

      <div class="box" id="box01_schoolname" style="display: none;"></div>
      <div class="box" id="box02_pa_schoolnum" style="display: none;"></div>
      <div class="box" id="box03_principal" style="display: none;"></div>
      <div class="box" id="box04_principalemail" style="display: none;"></div>
      <div class="box" id="box05_street_address" style="display: none;"></div>

      <script type="text/javascript">
         //always subscribe to ready event and implement widget related code
         //inside callback function , it is the best practice while developing widgets
         JFCustomWidget.subscribe("ready", function(){
            var url = "https://static.wcasd.net/files/buildings.json";

            var varschoolname = "";
            var varpa_schoolnum = "";
            var varschoolabbr = "";
            var varprincipal = "";
            var varprincipalemail = "";
            var varstreet_address = "";

            let data;
            $.getJSON(url, function (_data) {
            data = _data;

            console.log(data);

            /* no other change */
            $('#sel').append('<option value="' + index + '">' + data.name +
            '</option>');

            });
            //    });

            $("select").change(function(){
               $(this).find("option:selected").each(function(){
                  var optionValue = $(this).attr("value");

                  if(optionValue){
                     $("#box01_schoolname").text(data[optionValue].name);
                     varschoolname = data[optionValue].name;
                     
                     $("#box02_pa_schoolnum").text(data[optionValue].pa_schoolnum);
                     varpa_schoolnum = data[optionValue].pa_schoolnum;

                     $("#box03_principal").text(data[optionValue].principal);
                     varprincipal = data[optionValue].principal;

                     $("#box04_principalemail").text(data[optionValue].principalemail);
                     varprincipalemail = data[optionValue].principalemail;

                     $("#box05_street_address").text(data[optionValue].street_address);
                     varstreet_address = data[optionValue].street_address;

                     //
                     varschoolabbr = data[optionValue].schoolabbr;

                     $(".box").show();
                     /*
                     $(".box").not("." + optionValue).hide();
                     $("#sol").text(optionValue);
                     $("." + optionValue).show();
                     */

                  } else{
                     $(".box").hide();
                  }
               });
            }).change();

             // Listen for the submit event
            JFCustomWidget.subscribe("submit", function(){
                  // Prepare the data to be submitted
                  var msg = {
                     value: JSON.stringify({
                        pa_schoolnum: varpa_schoolnum,
                        schoolabbr: varschoolabbr,
                        principalemail: varprincipalemail+"@wcasd.k12.pa.us",
                        schoolname: varschoolname,                        
                        principal: varprincipal,                        
                        street_address: varstreet_address,

                     }),
                     valid: true // Set to false if the validation fails
                  };
                  

                  console.log("what is going to be submitted:");
                  console.log(msg);

                  JFCustomWidget.sendSubmit(msg);
            });

         });
      </script>


      <!-- <script type="text/javascript">
         $(document).ready(function(){
            //var url = "https://static.wcasd.net/devices.json";
            var url = "https://static.wcasd.net/files/buildings.json";

            let data;
            $.getJSON(url, function (_data) {
            data = _data;

            console.log(data);

            /* no other change */
            $('#sel').append('<option value="' + index + '">' + data.name +
            '</option>');

            });
            //    });

            $("select").change(function(){
            $(this).find("option:selected").each(function(){
               var optionValue = $(this).attr("value");

               if(optionValue){
                  $("#box01_schoolname").text(data[optionValue].name);
                  $("#box02_pa_schoolnum").text(data[optionValue].pa_schoolnum);
                  $("#box03_principal").text(data[optionValue].principal);
                  $("#box04_principalemail").text(data[optionValue].principalemail);
                  $("#box05_street_address").text(data[optionValue].street_address);
                  $(".box").show();
                  /*
                  $(".box").not("." + optionValue).hide();
                  $("#sol").text(optionValue);
                  $("." + optionValue).show();
                  */
               } else{
                  $(".box").hide();
               }
            });
            }).change();
         });

         //always subscribe to ready event and implement widget related code
         //inside callback function , it is the best practice while developing widgets
         JFCustomWidget.subscribe("ready", function(){
            var label = JFCustomWidget.getWidgetSetting('QuestionLabel');
            document.getElementById('labelText').innerHTML = label;
         });
         //subscribe to form submit event
         JFCustomWidget.subscribe("submit", function(){
            var msg = {
               //you should valid attribute to data for JotForm
               //to be able to use youw widget as required
               valid: true,
               
               //value: document.getElementById('buildings').value

               value: JSON.stringify({
                  schoolname: document.getElementById('box01_schoolname').text,
                  pa_schoolnum: document.getElementById('box02_pa_schoolnum').text,
                  principal: document.getElementById('box03_principal').text,
                  principalemail: document.getElementById('box04_principalemail').text,
                  street_address: document.getElementById('box05_street_address').text
               })

               //value: JSON.stringify([list])

            }
            // send value to JotForm
            JFCustomWidget.sendSubmit(msg);
         });

      </script>-->

      </form>

      <div class="as-console-wrapper">
         <div class="as-console"></div>
      </div>
   

<div class="calendly-opti-root calendly-lifecycle-optibutton_singleton"></div><div class="calendly-frame-tag" manager_id="1311b03d-f7bd-48a9-8b2e-ece5657abcff" id="1311b03d-f7bd-48a9-8b2e-ece5657abcff" style="height: 0px; width: 0px; visibility: hidden;"></div></body></html>
